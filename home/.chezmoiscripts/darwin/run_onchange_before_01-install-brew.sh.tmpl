#!/usr/bin/env zsh

if ! command -v brew &> /dev/null; then
    echo "  Homebrew not found. Installing..."
    # Install Homebrew using the official installation script.
    # The script is downloaded via curl and executed with /bin/bash.
    # The installation is non-interactive.
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    
    # Add Homebrew to the PATH for the current shell session.
    # This is necessary because the installer adds it to shell profile files
    # (.zprofile, .bash_profile), but those aren't sourced by the current script.
    # This setup is for Apple Silicon Macs.
    if [[ -x "/opt/homebrew/bin/brew" ]]; then
        eval "$(/opt/homebrew/bin/brew shellenv)"
    # This setup is for Intel Macs.
    elif [[ -x "/usr/local/bin/brew" ]]; then
        eval "$(/usr/local/bin/brew shellenv)"
    fi

    echo "  Homebrew installed successfully."
else
    echo "  Homebrew is already installed. Skipping."
fi
